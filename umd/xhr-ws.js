!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).HttpWs={})}(this,function(e){"use strict";function t(f,d){return function(c){return new Promise(function(t){var e=c.url,n=c.headers,r=d||{},o=r.headers,i=r.timeout,s=void 0===i?4e3:i,u=new XMLHttpRequest;function a(e){e&&e.target?t(e.target.response):t({error:"XMLHttpRequest callback is error"})}u.addEventListener("load",a),u.addEventListener("error",a),u.addEventListener("timeour",function(){t({error:"time out: "+s+"ms",url:f})}),e?u.open("POST",f+e,!0):u.open("POST",f,!0),u.timeout=s,u.responseType="json",u.setRequestHeader("content-type","application/json"),o&&Object.keys(o).forEach(function(e){u.setRequestHeader(e,o[e])}),n&&Object.keys(n).forEach(function(e){u.setRequestHeader(e,n[e])}),u.send(JSON.stringify(c))})}}function n(e){var i,s=0,u={};function a(){i&&i.close(),(i=new WebSocket(e)).onmessage=function(e){var t=JSON.parse(e.data);t._ws&&u[t._ws]&&u[t._ws](t)}}return a(),function(o){return new Promise(function(n){6e4<(s+=1)&&(s=0);var e=s;o._ws=e;var t,r=JSON.stringify(o);!function e(){t&&(clearTimeout(t),t=null),1<i.readyState?(a(),t=setTimeout(function(){e()},3e3)):i.send(r)}(),u[e]=function(e){var t=e.theWs;e._ws=void 0,n(e),delete u[t]}})}}window.createHttpClient=t,window.createWsClient=n,e.createHttpClient=t,e.createWsClient=n,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=xhr-ws.js.map
