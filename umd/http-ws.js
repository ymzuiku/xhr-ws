!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).HttpWs={})}(this,function(e){"use strict";function t(a,c){return function(u){return new Promise(function(t){var e=c||{},n=e.headers,r=e.timeout,o=void 0===r?4e3:r,i=new XMLHttpRequest;function s(e){e&&e.target?t(e.target.response):t({error:"XMLHttpRequest callback is error"})}i.addEventListener("load",s),i.addEventListener("error",s),i.addEventListener("timeour",function(){t({error:"time out: "+o+"ms",url:a})}),i.open("POST",a,!0),i.timeout=o,i.responseType="json",i.setRequestHeader("content-type","application/json"),n&&Object.keys(n).forEach(function(e){i.setRequestHeader(e,n[e])}),i.send(JSON.stringify(u))})}}function n(e){var i,t=e,s={},u=0;function a(){(i=new WebSocket(t)).onmessage=function(e){var t=JSON.parse(e.data);t.wsName&&s[t.wsName]&&s[t.wsName](t)}}return a(),function(e){return new Promise(function(t){6e4<(u+=1)&&(u=0);var n=u;e.wsName=n;var r,o=JSON.stringify(e);!function e(){r&&(clearTimeout(r),r=null),1!==i.readyState?(a(),r=setTimeout(function(){e()},2e3)):i.send(o)}(),s[n]=function(e){t(e),delete s[n]}})}}window.createHttpClient=t,window.createWsClient=n,e.createHttpClient=t,e.createWsClient=n,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=http-ws.js.map
